"use strict";(()=>{var e={};e.id=290,e.ids=[290],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7468:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>P,patchFetch:()=>R,requestAsyncStorage:()=>E,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var o={};r.r(o),r.d(o,{POST:()=>_,dynamic:()=>d});var s=r(921),a=r(7380),n=r(4185),i=r(3878),p=r(8231),u=r(6415);let d="force-dynamic";async function _(e){try{let t;let r=await e.formData(),o=r.get("prompt"),s=r.get("model"),a=r.get("motionModule"),n=Number(r.get("frames")),d=r.get("outputType"),_=r.get("file");if(!o)throw new u.MS("Prompt is required",400,"MISSING_PROMPT");_&&((0,u.D0)(_),t=await (0,u.s3)(_));let c=await fetch(p.H.RUNPOD_ENDPOINT_URL,{method:"POST",headers:{Authorization:`Bearer ${p.H.RUNPOD_API_KEY}`,"Content-Type":"application/json"},body:JSON.stringify({input:{prompt:o,model:s,motion_module:a,num_frames:n,output_type:d,reference_image:t,webhook:p.H.RUNPOD_WEBHOOK_URL}})});if(!c.ok)throw await c.json();let E=await c.json();return i.NextResponse.json({id:E.id,status:"PENDING"})}catch(e){if(e instanceof u.MS)return i.NextResponse.json({error:e.message,code:e.code},{status:e.status});return(0,u.dh)(e)}}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/generate/route",pathname:"/api/generate",filename:"route",bundlePath:"app/api/generate/route"},resolvedPagePath:"/home/ubuntu/CinematicAIGenerator/app/app/api/generate/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:E,staticGenerationAsyncStorage:l,serverHooks:m}=c,P="/api/generate/route";function R(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},8231:(e,t,r)=>{r.d(t,{H:()=>o});let o={RUNPOD_API_KEY:process.env.RUNPOD_API_KEY,RUNPOD_ENDPOINT_URL:process.env.RUNPOD_ENDPOINT_URL,RUNPOD_WEBHOOK_URL:process.env.RUNPOD_WEBHOOK_URL,MAX_FILE_SIZE:10485760,ALLOWED_FILE_TYPES:["image/jpeg","image/png","image/gif","video/mp4"],POLL_INTERVAL:2e3,MAX_POLL_TIME:3e5}},6415:(e,t,r)=>{r.d(t,{D0:()=>n,MS:()=>s,dh:()=>i,s3:()=>a});var o=r(8231);class s extends Error{constructor(e,t=500,r="INTERNAL_SERVER_ERROR"){super(e),this.status=t,this.code=r,this.name="ApiError"}}let a=async e=>new Promise((t,r)=>{let o=new FileReader;o.readAsDataURL(e),o.onload=()=>{t(o.result.split(",")[1])},o.onerror=e=>r(e)}),n=e=>{if(e.size>o.H.MAX_FILE_SIZE)throw new s("File size exceeds limit",400,"FILE_TOO_LARGE");if(!o.H.ALLOWED_FILE_TYPES.includes(e.type))throw new s("File type not supported",400,"INVALID_FILE_TYPE")},i=e=>{if(console.error("RunPod API Error:",e),e.response?.status===429)throw new s("Rate limit exceeded",429,"RATE_LIMIT_EXCEEDED");if(e.response?.status===401)throw new s("Invalid API key",401,"INVALID_API_KEY");throw new s(e.message||"An error occurred while processing your request",e.response?.status||500)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[923,146],()=>r(7468));module.exports=o})();